from __future__ import print_function
import jsonctmctree.ll, jsonctmctree.interface
from CodonGeneconv import *
import numdifftools as nd
import numpy as np


class test:
    def __init__(self):
        self.index = 0


    def sum_branch_test1(self):

        step = nd.step_generators.MaxStepGenerator(base_step=[1,2])
        print(step)
        print(nd.Hessian(self.testfunction, step=step)([0,0]))


    def testfunction(self,x):
        print(x)
        self.index += 1
        print(self.index)
        return (x[0] ** 2+x[1]**2 +x[1]*x[0]+2*x[0])

    def print11(self):
        step_gen = nd.step_generators.BasicMaxStepGenerator(base_step=2.0, step_ratio=2,
                                                            num_steps = 4)

        for s in step_gen():
            print(s)

        print(np.log1p(np.abs(4)).clip(min=1.0))

    def test1(self):
        basic = np.maximum(30 / (2 * (np.maximum(np.log(np.exp(30) + 1), 1))) - 0.4,0.2)
        step = nd.step_generators.MaxStepGenerator(base_step=basic)
        print(step)




if __name__ == '__main__':
    self=test()
    self.sum_branch_test1()



